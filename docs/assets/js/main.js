!function(e){var t=e(window),a=e("body"),l=(e("#wrapper"),e("#header")),n=e("#footer"),r=e("#main"),c=r.children("article");t.on("load",function(){window.setTimeout(function(){a.removeClass("is-preload")},100)});var i=l.children("nav"),s=i.find("li");s.length%2==0&&(i.addClass("use-middle"),s.eq(s.length/2).addClass("is-middle"));var o,h,d,u=325,f=!1;r._show=function(i,e){var s,o=c.filter("#"+i);if(0!=o.length){if(f||void 0!==e&&!0===e)return a.addClass("is-switching"),a.addClass("is-article-visible"),c.removeClass("active"),l.hide(),n.hide(),r.show(),o.show(),o.addClass("active"),f=!1,void setTimeout(function(){a.removeClass("is-switching")},e?1e3:0);f=!0,a.hasClass("is-article-visible")?((s=c.filter(".active")).removeClass("active"),setTimeout(function(){s.hide(),o.show(),setTimeout(function(){o.addClass("active"),t.scrollTop(0).triggerHandler("resize.flexbox-fix"),setTimeout(function(){f=!1},u)},25)},u)):(a.addClass("is-article-visible"),setTimeout(function(){l.hide(),n.hide(),r.show(),o.show(),setTimeout(function(){o.addClass("active"),t.scrollTop(0).triggerHandler("resize.flexbox-fix"),setTimeout(function(){f=!1},u)},25)},u))}},r._hide=function(i){var e=c.filter(".active");if(a.hasClass("is-article-visible")){if(void 0!==i&&!0===i&&history.pushState(null,null,"#"),f)return a.addClass("is-switching"),e.removeClass("active"),e.hide(),r.hide(),n.show(),l.show(),a.removeClass("is-article-visible"),f=!1,a.removeClass("is-switching"),void t.scrollTop(0).triggerHandler("resize.flexbox-fix");f=!0,e.removeClass("active"),setTimeout(function(){e.hide(),r.hide(),n.show(),l.show(),setTimeout(function(){a.removeClass("is-article-visible"),t.scrollTop(0).triggerHandler("resize.flexbox-fix"),setTimeout(function(){f=!1},u)},25)},u)}},c.each(function(){var i=e(this);e('<div class="close">Close</div>').appendTo(i).on("click",function(){location.hash=""}),i.on("click",function(i){i.stopPropagation()})}),a.on("click",function(i){a.hasClass("is-article-visible")&&r._hide(!0)}),t.on("keyup",function(i){27===i.keyCode&&a.hasClass("is-article-visible")&&r._hide(!0)}),t.on("hashchange",function(i){""==location.hash||"#"==location.hash?(i.preventDefault(),i.stopPropagation(),r._hide()):0<c.filter(location.hash).length&&(i.preventDefault(),i.stopPropagation(),r._show(location.hash.substr(1)))}),"scrollRestoration"in history?history.scrollRestoration="manual":(h=o=0,d=e("html,body"),t.on("scroll",function(){o=h,h=d.scrollTop()}).on("hashchange",function(){t.scrollTop(o)})),r.hide(),c.hide(),""!=location.hash&&"#"!=location.hash&&t.on("load",function(){r._show(location.hash.substr(1),!0)})}(jQuery);